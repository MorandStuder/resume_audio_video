Sub DeleteLargeAttachments()

'Définissez les paramètres de la recherche
Dim strSearch As String
Dim strFolder As String
Dim dtDate As Date

strSearch = "hasattachments:yes"
strFolder = "Boîte de réception"
dtDate = DateAdd("d", -2000, Now)

'Exécutez la recherche
Set objFolder = Outlook.Application.Session.GetDefaultFolder(strFolder)
Set objItems = objFolder.Items

'Parcourez les messages
For Each objItem In objItems

'Vérifiez la taille de la pièce jointe
Dim strAttachment As String
Dim intSize As Long

strAttachment = objItem.Attachments(1).FileName
intSize = objItem.Attachments(1).Size

'Supprimez la pièce jointe si elle est volumineuse et si le message a été reçu avant la date spécifiée
If intSize > 1000000 And objItem.ReceivedTime < dtDate Then
objItem.Attachments(1).Delete
End If

Next

End Sub